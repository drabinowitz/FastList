!function(t){"use strict";function e(t,e){return null===t&&(t="null"),null===e&&(e="null"),t.toString()<e.toString()?-1:1}function n(t){this.value=t.value,this.next=t.next||null,this.parent=t.parent||null,this.__key__=t.key}function r(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return e}var i=function(){this.head=null,this.tail=null,this.length=0,this.listIndex={}};i.prototype._mustFind=function(t){var e=this.listIndex[t];if(e)return e;throw new Error(t+" does not reference an existing node.  Create a node with this key first using an add method")},i.prototype._mustNotFind=function(t){if(this.listIndex[t])throw new Error(t+" already refers to an existing node.  Use 'set' to update an existing node or make sure to pass in a unique key.")},i.prototype._add=function(t,e){e=e||r();try{this._mustNotFind(e);var i=new n({value:t,key:e});return this.listIndex[e]=i,this.length++,i}catch(a){throw a}},i.prototype._addFirst=function(t,e){if(this.length)throw new Error("List already has elements.  Use add before/after instead");return this.head=this.tail=this._add(t,e),this.head.__key__},i.prototype._placeIn=function(t,e,n){try{var r=this._mustFind(e),i=n?"parent":"next",a=n?"next":"parent";r[i]&&(t[i]=r[i],r[i][a]=t),t[a]=r,r[i]=t,n&&r===this.head?this.head=t:n||r!==this.tail||(this.tail=t)}catch(o){throw o}},i.prototype.addBefore=function(t,e,n){try{var r=this._add(e,n);return this._placeIn(r,t,!0),r.__key__}catch(i){throw i}},i.prototype.addAfter=function(t,e,n){try{var r=this._add(e,n);return this._placeIn(r,t,!1),r.__key__}catch(i){throw i}},i.prototype.addToTail=function(t,e){return this.head?this.addAfter(this.tail.__key__,t,e):this._addFirst(t,e)},i.prototype.addToHead=function(t,e){return this.head?this.addBefore(this.head.__key__,t,e):this._addFirst(t,e)},i.prototype.removeAt=function(t){var e=this.listIndex[t];return e?(e.parent?e.parent.next=e.next:this.head===e&&(this.head=e.next),e.next?e.next.parent=e.parent:this.tail===e&&(this.tail=e.parent),delete this.listIndex[t],this.length--,e.value):void 0},i.prototype.removeFromHead=function(){return this.head?this.removeAt(this.head.__key__):null},i.prototype.removeFromTail=function(){return this.tail?this.removeAt(this.tail.__key__):null},i.prototype.get=function(t){var e=this.listIndex[t];return e?e.value:void 0},i.prototype.set=function(t,e){try{var n=this._mustFind(t);n.value=e}catch(r){throw r}},i.prototype.forEach=i.prototype.each=function(t){for(var e=this.head;e;e=e.next)t(e.value,e.__key__,this)},i.prototype.sort=function(t){t=t||e;for(var n=this.head;n;n=n.next)for(var r=n.parent;r&&t(n.value,r.value)<0;)r.next=n.next,n.parent=r.parent,r===this.head?this.head=n:r.parent.next=n,n===this.tail?this.tail=r:n.next.parent=r,r.parent=n,n.next=r,r=n.parent},t.FastList=i}(window);